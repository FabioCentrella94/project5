(self.webpackChunkproject5_frontend=self.webpackChunkproject5_frontend||[]).push([[543],{543:function(){let t=document.getElementById("loadingGif"),e=document.getElementById("alert");document.getElementById("cartContainer");if(navigator.onLine){let a=document.getElementById("cart");if(null===localStorage.getItem("totalItemInCart")){document.getElementById("displayTotalItem").textContent="Cart (0)"}else document.getElementById("displayTotalItem").textContent="Cart ("+localStorage.getItem("totalItemInCart")+")";let n=[];for(let t in localStorage)localStorage.hasOwnProperty(t)&&n.push(JSON.parse(localStorage[t]));let l=[];n.forEach((t=>{Object.keys(t).forEach((e=>{l.push(t[e])}))}));let r=[];for(i=0;i<l.length;i++)r[i]=new Array(l[i].quantity).fill(l[i].id);let o=[].concat.apply([],r);for(i=0;i<l.length;i++){let t=document.createElement("figure");t.setAttribute("class","col-12");let e=document.createElement("img");e.src=l[i].image,t.appendChild(e);let a=document.createElement("figcaption");t.appendChild(a);let n=document.createElement("p");n.textContent=l[i].color,a.appendChild(n);let r=document.createElement("p");r.textContent="$"+(l[i].price/100).toFixed(2),a.appendChild(r);let o=document.createElement("div");o.style.display="flex",o.style.justifyContent="space-around",o.style.alignItems="center",a.appendChild(o);let m=document.createElement("button");m.textContent="-",m.value=l[i].color,m.name=l[i].id,m.setAttribute("class","minusButton bg-secondary text-light rounded-circle"),o.appendChild(m);let d=document.createElement("p");d.textContent=l[i].quantity,o.appendChild(d);let c=document.createElement("button");c.textContent="+",c.value=l[i].color,c.name=l[i].id,c.setAttribute("class","plusButton bg-secondary text-light rounded-circle"),o.appendChild(c);let g=document.createElement("p");g.textContent="$"+(l[i].price*l[i].quantity/100).toFixed(2),a.appendChild(g);let u=document.createElement("button");u.setAttribute("class","removeItem bg-secondary text-light"),u.textContent="Remove Item",u.value=l[i].color,u.name=l[i].id,a.appendChild(u),document.getElementById("cart").appendChild(t)}let m=document.querySelectorAll(".minusButton");for(i=0;i<m.length;i++)m[i].addEventListener("click",(t=>{let n=localStorage.getItem("totalItemInCart");n=parseInt(n),localStorage.setItem("totalItemInCart",n-1),itemInCart=localStorage.getItem(t.target.name),itemInCart=JSON.parse(itemInCart),document.getElementById("displayTotalItem").textContent="Cart ("+localStorage.getItem("totalItemInCart")+")";let l=localStorage.getItem("totalCost");l=parseInt(l),localStorage.setItem("totalCost",l-itemInCart[t.target.value].price),itemInCart[t.target.value].quantity>1?(itemInCart[t.target.value].quantity-=1,t.target.parentElement.nextElementSibling.textContent="$"+(itemInCart[t.target.value].price*itemInCart[t.target.value].quantity/100).toFixed(2)):delete itemInCart[t.target.value],localStorage.setItem(t.target.name,JSON.stringify(itemInCart)),"{}"==localStorage.getItem(t.target.name)&&localStorage.removeItem(t.target.name),t.target.nextSibling.textContent=Number(t.target.nextSibling.textContent)-1,t.target.nextSibling.textContent<1&&(e.removeAttribute("hidden"),setTimeout((()=>{e.setAttribute("hidden","true")}),1e3),a.removeChild(t.target.parentElement.parentElement.parentElement)),a.childNodes.length<1&&location.reload()}));let d=document.querySelectorAll(".plusButton");for(i=0;i<d.length;i++)d[i].addEventListener("click",(t=>{let e=localStorage.getItem("totalItemInCart");e=parseInt(e),localStorage.setItem("totalItemInCart",e+1),itemInCart=localStorage.getItem(t.target.name),itemInCart=JSON.parse(itemInCart),document.getElementById("displayTotalItem").textContent="Cart ("+localStorage.getItem("totalItemInCart")+")",itemInCart[t.target.value].quantity+=1,t.target.parentElement.nextElementSibling.textContent="$"+(itemInCart[t.target.value].price*itemInCart[t.target.value].quantity/100).toFixed(2),localStorage.setItem(t.target.name,JSON.stringify(itemInCart));let a=localStorage.getItem("totalCost");a=parseInt(a),localStorage.setItem("totalCost",a+itemInCart[t.target.value].price),t.target.previousSibling.textContent=Number(t.target.previousSibling.textContent)+1}));let c=document.querySelectorAll(".removeItem");for(i=0;i<c.length;i++)c[i].addEventListener("click",(t=>{e.removeAttribute("hidden"),setTimeout((()=>{e.setAttribute("hidden","true")}),1e3);let n=localStorage.getItem("totalItemInCart");n=parseInt(n),itemInCart=localStorage.getItem(t.target.name),itemInCart=JSON.parse(itemInCart);let l=localStorage.getItem("totalCost");l=parseInt(l),localStorage.setItem("totalCost",l-itemInCart[t.target.value].price*itemInCart[t.target.value].quantity),localStorage.setItem("totalItemInCart",n-itemInCart[t.target.value].quantity),delete itemInCart[t.target.value],localStorage.setItem(t.target.name,JSON.stringify(itemInCart)),document.getElementById("displayTotalItem").textContent="Cart ("+localStorage.getItem("totalItemInCart")+")","{}"==localStorage.getItem(t.target.name)&&localStorage.removeItem(t.target.name),a.removeChild(t.target.previousSibling.parentElement.parentElement),a.childNodes.length<1&&location.reload()}));let g={firstName:"",lastName:"",address:"",city:"",email:""},u=document.querySelectorAll(".form-group");for(i=0;i<u.length;i++){let t=document.createElement("p");u[i].appendChild(t)}let s=document.getElementById("submitOrder"),p=document.querySelectorAll("input"),I=document.getElementById("inputForm"),C=document.getElementById("formContainer");if(o.length>=1)for(I.removeAttribute("hidden"),i=0;i<p.length;i++)p[i].addEventListener("input",(t=>{h(t)})),p[i].addEventListener("blur",(t=>{h(t)}));else{I.setAttribute("hidden","true");let t=document.createElement("p");t.setAttribute("class","font-weight-bold mt-5"),t.textContent="Your Cart Is Empty",C.appendChild(t)}const h=t=>{t.target.value.length<1?(t.target.style.border="2px solid red",t.target.nextElementSibling.style.color="red",t.target.nextElementSibling.textContent="Field Required"):t.target.value.length>=1&&!t.target.value.match(t.target.pattern)?(t.target.style.border="2px solid red",t.target.nextElementSibling.style.color="red",t.target.nextElementSibling.textContent="Format Not Valid"):(t.target.style.border="2px solid greenyellow",t.target.nextElementSibling.style.color="green",t.target.nextElementSibling.textContent="Valid "+t.target.name)};for(i=0;i<p.length;i++)p[i].addEventListener("input",(()=>{p[0].value.length>=1&&p[0].value.match(p[0].pattern)&&p[1].value.length>=1&&p[1].value.match(p[1].pattern)&&p[2].value.length>=1&&p[2].value.match(p[2].pattern)&&p[3].value.length>=1&&p[3].value.match(p[3].pattern)&&p[4].value.length>=1&&p[4].value.match(p[4].pattern)?s.removeAttribute("hidden"):s.setAttribute("hidden","true")}));s.addEventListener("click",(e=>{for(document.getElementById("cartPage").setAttribute("hidden","true"),t.removeAttribute("hidden"),e.preventDefault(),y(),p[0].value.length>=1&&p[0].value.match(p[0].pattern)&&p[1].value.length>=1&&p[1].value.match(p[1].pattern)&&p[2].value.length>=1&&p[2].value.match(p[2].pattern)&&p[3].value.length>=1&&p[3].value.match(p[3].pattern)&&p[4].value.length>=1&&p[4].value.match(p[4].pattern)&&v(),i=0;i<p.length;i++)p[i].value=""}));const y=()=>{g.firstName=p[0].value,g.lastName=p[1].value,g.address=p[2].value,g.city=p[3].value,g.email=p[4].value},v=()=>{const e=new Promise(((t,e)=>{let a=[];for(let t in localStorage)localStorage.hasOwnProperty(t)&&a.push(JSON.parse(localStorage[t]));let n=[];a.forEach((function(t){Object.keys(t).forEach((e=>{n.push(t[e])}))}));let l=[];for(i=0;i<n.length;i++)l[i]=new Array(n[i].quantity).fill(n[i].id);let r=[].concat.apply([],l),o=new XMLHttpRequest,m={contact:g,products:r};o.open("POST","https://project5-backend.myportfolio.training/api/teddies/order",!0),o.setRequestHeader("Content-type","application/json"),o.send(JSON.stringify(m)),o.onreadystatechange=()=>{4===o.readyState&&(201===o.status?t(JSON.parse(o.response)):e(o.response))}}));e.then((t=>{sessionStorage.setItem("orderTotalPrice",localStorage.getItem("totalCost")),localStorage.clear(),sessionStorage.setItem("orderDetail",JSON.stringify(t)),location.href="orderConfirmation.html"})).catch((e=>{if(null===localStorage.getItem("totalItemInCart")){document.getElementById("displayTotalItem").textContent="Cart (0)"}else document.getElementById("displayTotalItem").textContent="Cart ("+localStorage.getItem("totalItemIncart")+")";if(console.log(e),t.setAttribute("hidden","true"),e){let t=document.createElement("p");t.textContent="There is a problem with the backend";let e=document.getElementById("cartPage");e.removeAttribute("hidden"),e.removeChild(e.childNodes[1]),I.setAttribute("hidden","true"),C.className="col-12 text-center pt-5",C.appendChild(t)}else{let t=document.createElement("p");t.textContent="Error: Network Error";let e=document.getElementById("cartPage");e.removeAttribute("hidden"),e.removeChild(e.childNodes[1]),I.setAttribute("hidden","true"),C.className="col-12 text-center pt-5",C.appendChild(t)}}))}}else window.document.addEventListener("DOMContentLoaded",(()=>{if(null===localStorage.getItem("totalItemInCart")){document.getElementById("displayTotalItem").textContent="Cart (0)"}else document.getElementById("displayTotalItem").textContent="Cart ("+localStorage.getItem("totalItemInCart")+")";t.setAttribute("hidden","true");let e=document.getElementById("cartPage");e.removeAttribute("hidden"),e.removeChild(e.childNodes[1]),document.getElementById("inputForm").setAttribute("hidden","true");let a=document.getElementById("formContainer");a.className="col-12 text-center pt-5",a.innerHTML="No Connection"}))}}]);